(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/evaluate/evaluate"],{"21ba":function(e,t,n){"use strict";n.r(t);var a=n("7989"),r=n("8d42");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("d697");var i,u=n("f0c5"),c=Object(u["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],i);t["default"]=c.exports},7989:function(e,t,n){"use strict";var a={"uni-segmented-control":function(){return n.e("components/uni-segmented-control/uni-segmented-control").then(n.bind(null,"e02b"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,(new Date).getTime());e.$mp.data=Object.assign({},{$root:{g0:n}})},o=[];n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},"8d42":function(e,t,n){"use strict";n.r(t);var a=n("afe0"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},afe0:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){n.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("2ead"))}.bind(null,n)).catch(n.oe)},r=function(){n.e("common/vendor").then(function(){return resolve(n("e201"))}.bind(null,n)).catch(n.oe)},o=function(){n.e("common/vendor").then(function(){return resolve(n("250c"))}.bind(null,n)).catch(n.oe)},i=function(){n.e("components/uni-segmented-control/uni-segmented-control").then(function(){return resolve(n("e02b"))}.bind(null,n)).catch(n.oe)},u={components:{uniNavBar:a,vanButton:r,uniSegmentedControl:i,vanCountDown:o},data:function(){return{nav:{top:0,height:0},phone:"",nickName:"",evaluateAfter:[],evaluateAfterOrder:[],evaluateBefore:[],evaluateBeforeOrder:[],cancel:[],cancelOrder:[],paid:[],paidOrder:[],obligation:[],obligationOrder:[],items:["待付款","已支付","已取消","待评价","已评价"],current:0}},created:function(){var t=e.getMenuButtonBoundingClientRect();this.nav.top=t.top,this.nav.height=t.height},mounted:function(){this.getUserAndPhone(),this.Init()},methods:{finish:function(e){console.log(e),this.onCancel(e)},getUserAndPhone:function(){var t=e.getStorageSync("token"),n=e.getStorageSync("phone");this.nickName=t.nickName,this.phone=n},checkEvaluate:function(t){e.navigateTo({url:"../allComment/allComment"})},EvaluateAfter:function(){var t=this,n=e.getStorageSync("tableNum");e.request({url:"http://129.211.13.120:3000/ordering/wx/evaluateAfter",data:{tableNum:n,name:this.nickName,phone:this.phone},method:"GET",success:function(e){for(var n in t.evaluateAfter=e.data.arr,t.evaluateAfterOrder=e.data.order,t.evaluateAfterOrder){var a=0;for(var r in t.evaluateAfter)for(var o in t.evaluateAfter[r])t.evaluateAfterOrder[n].id===t.evaluateAfter[r][o].orderId&&(a+=1);t.evaluateAfterOrder[n].total=a}}})},toEvaluate:function(t){e.navigateTo({url:"../comment/comment?id="+t})},EvaluateBefore:function(){var t=this,n=e.getStorageSync("tableNum");e.request({url:"http://129.211.13.120:3000/ordering/wx/evaluateBefore",data:{tableNum:n,name:this.nickName,phone:this.phone},method:"GET",success:function(e){for(var n in t.evaluateBefore=e.data.arr,t.evaluateBeforeOrder=e.data.order,t.evaluateBeforeOrder){var a=0;for(var r in t.evaluateBefore)for(var o in t.evaluateBefore[r])t.evaluateBeforeOrder[n].id===t.evaluateBefore[r][o].orderId&&(a+=1);t.evaluateBeforeOrder[n].total=a}}})},toDelete:function(t){e.request({url:"http://129.211.13.120:3000/ordering/wx/cancel",method:"put",data:{id:t},success:function(e){console.log(e.data)}})},Cancel:function(){var t=this,n=e.getStorageSync("tableNum");e.request({url:"http://129.211.13.120:3000/ordering/wx/cancelTab",data:{tableNum:n,name:this.nickName,phone:this.phone},method:"GET",success:function(e){for(var n in t.cancel=e.data.arr,t.cancelOrder=e.data.order,t.cancelOrder){var a=0;for(var r in t.cancel)for(var o in t.cancel[r])t.cancelOrder[n].id===t.cancel[r][o].orderId&&(a+=1);t.cancelOrder[n].total=a}}})},toPushMeal:function(t){this.$goEasy.publish({channel:"my_ch",message:"编号".concat(t,"的订单催单了~~")}),e.request({url:"http://129.211.13.120:3000/ordering/wx/pushMeal",method:"put",data:{id:t},success:function(e){console.log(e.data)}})},Paid:function(){var t=this,n=e.getStorageSync("tableNum");e.request({url:"http://129.211.13.120:3000/ordering/wx/paidTab",data:{tableNum:n,name:this.nickName,phone:this.phone},method:"GET",success:function(e){for(var n in t.paid=e.data.arr,t.paidOrder=e.data.order,t.paidOrder){var a=0;for(var r in t.paid)for(var o in t.paid[r])t.paidOrder[n].id===t.paid[r][o].orderId&&(a+=1);t.paidOrder[n].total=a}}})},toPay:function(t){var n=this;this.$goEasy.publish({channel:"my_channel",message:"有新订单到~~编号为".concat(t)}),e.request({url:"http://129.211.13.120:3000/ordering/wx/toPay",method:"put",data:{id:t},success:function(e){console.log(e.data),n.Init()}})},onCancel:function(t){var n=this;console.log(t),e.request({url:"http://129.211.13.120:3000/ordering/wx/delete",method:"DELETE",data:{id:t},success:function(e){console.log(e.data),n.Init()}})},onClickItem:function(e){this.current!==e.currentIndex&&(this.current=e.currentIndex),0===e.currentIndex?this.Init():1===e.currentIndex?this.Paid():2===e.currentIndex?this.Cancel():3===e.currentIndex?this.EvaluateBefore():4===e.currentIndex&&this.EvaluateAfter()},Init:function(){var t=this,n=e.getStorageSync("tableNum");e.request({url:"http://129.211.13.120:3000/ordering/wx/obligation",data:{tableNum:n,name:this.nickName,phone:this.phone},method:"GET",success:function(e){for(var n in t.obligation=e.data.arr,t.obligationOrder=e.data.order,t.obligationOrder){var a=0;for(var r in t.obligation)for(var o in t.obligation[r])t.obligationOrder[n].id===t.obligation[r][o].orderId&&(a+=1);t.obligationOrder[n].total=a,t.obligationOrder[n].time=new Date(t.obligationOrder[n].updatedAt.replace(/-/g,"/")).getTime()}console.log(t.obligationOrder)}})},goback:function(){e.reLaunch({url:"../index/index"})}}};t.default=u}).call(this,n("543d")["default"])},d697:function(e,t,n){"use strict";var a=n("f614"),r=n.n(a);r.a},e51c:function(e,t,n){"use strict";(function(e){n("b6b9"),n("921b");a(n("66fd"));var t=a(n("21ba"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},f614:function(e,t,n){}},[["e51c","common/runtime","common/vendor"]]]);